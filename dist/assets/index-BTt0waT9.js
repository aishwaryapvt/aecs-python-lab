import{loadPyodide as p}from"https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.mjs";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&d(c)}).observe(document,{childList:!0,subtree:!0});function m(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(e){if(e.ep)return;e.ep=!0;const n=m(e);fetch(e.href,n)}})();let y,i={homework:{},submissions:{}};async function h(){y=await p();const u=document.getElementById("student-login"),r=document.getElementById("teacher-login"),m=document.getElementById("set-homework"),d=document.getElementById("run-code"),e=document.getElementById("submit-code"),n=document.getElementById("student-panel"),c=document.getElementById("teacher-panel"),a=document.getElementById("login-form");let l=null;u.onclick=()=>{const t=document.getElementById("student-name").value.trim(),o=document.getElementById("student-roll").value.trim(),s=document.getElementById("student-class").value.trim();if(!t||!o||!s)return alert("Please fill all fields.");l={name:t,roll:o,cls:s},document.getElementById("student-id").textContent=`${t} (${o}, Class ${s})`,a.classList.add("hidden"),n.classList.remove("hidden"),document.getElementById("assigned-homework").innerText=i.homework[s]||"No homework assigned."},r.onclick=()=>{if(document.getElementById("teacher-pass").value!=="teacher123")return alert("Wrong password");a.classList.add("hidden"),c.classList.remove("hidden"),f()},m.onclick=()=>{const t=document.getElementById("target-class").value.trim(),o=document.getElementById("homework-text").value.trim();if(!t||!o)return alert("Enter class and homework.");i.homework[t]=o,alert(`Assigned to Class ${t}`)},d.onclick=async()=>{const t=document.getElementById("student-code").value;try{const o=await y.runPythonAsync(t);document.getElementById("code-output").innerText=o}catch(o){document.getElementById("code-output").innerText=o}},e.onclick=()=>{const t=document.getElementById("student-code").value,o=`${l.cls}-${l.roll}`;i.submissions[o]={...l,code:t,timestamp:new Date().toLocaleString()},alert("Code submitted!")};function f(){const t=document.getElementById("all-submissions");t.innerHTML="";for(const[o,s]of Object.entries(i.submissions)){const g=document.createElement("div");g.innerHTML=`<strong>${s.name} (${s.roll}, Class ${s.cls})</strong><br/>
        <em>Submitted at: ${s.timestamp}</em><br/>
        <pre>${s.code}</pre><hr/>`,t.appendChild(g)}}}h();
